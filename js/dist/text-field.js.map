{"version":3,"file":"text-field.js","sources":["../src/text-field.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Material Style (v3.0.0): text_field.js\n * Licensed under MIT (https://github.com/materialstyle/materialstyle/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport {\n  getBaseColor, getPrimaryColor\n} from './util/color.js'\nimport BaseComponent from './base-component.js'\nimport { defineJQueryPlugin } from './util/index.js'\n// import 'detect-autofill'\n\n/**\n * --------------------------------------------------------------------------\n * Constants\n * --------------------------------------------------------------------------\n */\n\nconst NAME = 'textfield'\nconst VERSION = '3.0.0'\n\nconst CLASS_NAME_FLOATING_MAIN = 'floating-label'\nconst CLASS_NAME_FLOATING_LINE = 'floating-label-line'\n\nconst LABEL_SCALE = 0.85\n\nclass TextField extends BaseComponent {\n  constructor(element) {\n    super(element)\n    this._textField = element\n    this._formFloating = element.closest(`.${CLASS_NAME_FLOATING_MAIN}`)\n\n    if (this._textField && this._formFloating) {\n      this.initTextFields()\n      this.addFontsReadyEvent()\n    }\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = TextField.getOrCreateInstance(this)\n\n      if (typeof config === 'string') {\n        if (typeof data[config] === 'undefined') {\n          throw new TypeError(`No method named \"${config}\"`)\n        }\n\n        data[config](this)\n      }\n    })\n  }\n\n  initTextFields() {\n    const baseColor = getBaseColor(this._textField)\n    const primaryColor = getPrimaryColor(this._textField)\n    const islined = this._textField.classList.contains(CLASS_NAME_FLOATING_LINE)\n\n    if (baseColor) {\n      this._textField.style.setProperty('--bs-form-field-border-color', baseColor)\n    }\n\n    if (primaryColor) {\n      this._textField.style.setProperty('--bs-form-field-active-border-color', primaryColor)\n    }\n\n    this._label = this._textField.nextElementSibling\n    this._inputGroup = this._textField.closest('.input-group')\n\n    if (this._inputGroup) {\n      if (islined) {\n        this._inputGroup.classList.add('has-floating-label')\n      } else {\n        this._inputGroup.classList.add('has-floating-label-outlined')\n      }\n    }\n\n    this._formFloatingWithIcon = this._textField.closest('.floating-label-with-icon')\n\n    if (this._formFloatingWithIcon) {\n      this._prepend = this._formFloatingWithIcon.querySelector('.prepend')\n      this._append = this._formFloatingWithIcon.querySelector('.append')\n    }\n\n    if (this._prepend) {\n      this._label.style.paddingLeft = 0\n    }\n\n    if (islined) {\n      this.addRipple()\n    } else {\n      this.addNotch()\n    }\n  }\n\n  // initTextFields() {\n  //   const baseColor = getBaseColor(this._formFloating)\n  //   const primaryColor = getPrimaryColor(this._formFloating)\n  //   const formFloatingRipple = this._formFloating.nextElementSibling\n  //\n  //   if (baseColor) {\n  //     this._formFloating.style.setProperty('--bs-form-field-border-color', baseColor)\n  //   }\n  //\n  //   if (primaryColor) {\n  //     this._formFloating.style.setProperty('--bs-form-field-active-border-color', primaryColor)\n  //   }\n  //\n  //   this._label = this._formFloating.querySelector('label')\n  //   this._inputGroup = this._formFloating.closest('.input-group')\n  //\n  //   if (this._inputGroup) {\n  //     if (this._formFloating.className.includes(CLASS_NAME_FLOATING_LINE)) {\n  //       this._inputGroup.classList.add('has-floating-label-lined')\n  //     } else {\n  //       this._inputGroup.classList.add('has-floating-label-outlined')\n  //     }\n  //   }\n  //\n  //   this._formFloatingWithIcon = this._formFloating.closest('.floating-label-with-icon')\n  //\n  //   if (this._formFloatingWithIcon) {\n  //     this._prepend = this._formFloatingWithIcon.querySelector('.prepend')\n  //     this._append = this._formFloatingWithIcon.querySelector('.append')\n  //   }\n  //\n  //   if (this._prepend) {\n  //     this._label.style.paddingLeft = 0\n  //   }\n  //   if (formFloatingRipple && formFloatingRipple.classList.contains('floating-label-ripple')) {\n  //     this.addRipple()\n  //   }\n  //\n  //   if (this._formFloating.className.includes(CLASS_NAME_FLOATING_MAIN)) {\n  //     this.addNotch()\n  //   }\n  //   // else {\n  //   //   this.addRipple()\n  //   // }\n  // }\n\n  redraw() {\n    if (this._label) {\n      this._formFloating.style.setProperty('--label-floating-margin-right', `-${this._label.offsetWidth - (this._label.offsetWidth * LABEL_SCALE)}px`)\n    }\n    if (this._formFloating.className.includes(CLASS_NAME_FLOATING_MAIN)) {\n      this._inputGroup.classList.add('has-floating-label-outlined')\n    } else {\n      this._inputGroup.classList.add('has-floating-label-lined')\n    }\n    this.addFontsReadyEvent()\n  }\n\n  addRipple() {\n    const ripple = document.createElement('div')\n    ripple.className = 'm-line-ripple'\n\n    this._ripple = ripple\n    this._textField.after(ripple)\n  }\n\n  addNotch() {\n    const notch = document.createElement('div')\n    notch.className = 'm-notch'\n\n    const notchBefore = document.createElement('div')\n    notchBefore.className = 'm-notch-before'\n\n    const notchBetween = document.createElement('div')\n    notchBetween.className = 'm-notch-between'\n\n    const notchAfter = document.createElement('div')\n    notchAfter.className = 'm-notch-after'\n\n    notch.append(notchBefore)\n    notch.append(notchBetween)\n    notch.append(notchAfter)\n\n    this._textField.after(notch)\n    this._notch = notch\n\n    if (this._label) {\n      notchBetween.append(this._label)\n      this._formFloating.style.setProperty('--label-floating-margin-right', `-${this._label.offsetWidth - (this._label.offsetWidth * LABEL_SCALE)}px`)\n    }\n  }\n\n  addFontsReadyEvent() {\n    document.fonts.ready.then(() => {\n      if (this._formFloatingWithIcon) {\n        if (this._prepend) {\n          this._prepend.style.height = `${this._textField.offsetHeight}px`\n          this._formFloating.style.setProperty('--prepend-width', `${this._prepend.offsetWidth}px`)\n        }\n\n        if (this._append) {\n          this._append.style.height = `${this._textField.offsetHeight}px`\n          this._formFloating.style.setProperty('--append-width', `${this._append.offsetWidth}px`)\n        }\n      }\n    })\n  }\n}\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\ndefineJQueryPlugin(TextField)\n\nexport default TextField\n"],"names":["NAME","VERSION","CLASS_NAME_FLOATING_MAIN","CLASS_NAME_FLOATING_LINE","LABEL_SCALE","TextField","BaseComponent","constructor","element","_textField","_formFloating","closest","initTextFields","addFontsReadyEvent","jQueryInterface","config","each","data","getOrCreateInstance","TypeError","baseColor","getBaseColor","primaryColor","getPrimaryColor","islined","classList","contains","style","setProperty","_label","nextElementSibling","_inputGroup","add","_formFloatingWithIcon","_prepend","querySelector","_append","paddingLeft","addRipple","addNotch","redraw","offsetWidth","className","includes","ripple","document","createElement","_ripple","after","notch","notchBefore","notchBetween","notchAfter","append","_notch","fonts","ready","then","height","offsetHeight","defineJQueryPlugin"],"mappings":"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"}